# Four Against Darkness - Development Guide

This is a Vite + React application for the "Four Against Darkness" solo tabletop game companion app.

## Running Locally

### Prerequisites

- **Node.js** version 18 or higher
- **npm** (comes with Node.js)

### Quick Start

1. **Install dependencies**

  ```bash
  npm install
  ```

2. **Start the development server**

  ```bash
  npm run dev
  ```

  The app will be available at `http://localhost:5173` (or another port if 5173 is in use).

3. **Build for production** (optional)

  ```bash
  npm run build
  ```

4. **Preview production build** (optional)

  ```bash
  npm run preview
  ```

## Project Architecture

```
4ad-tabs/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ App.jsx              # Main app shell (layout, tabs, routing)
â”‚   â”œâ”€â”€ main.jsx             # Application entry point
â”‚   â”œâ”€â”€ index.css            # Global styles (Tailwind)
â”‚   â”‚
â”‚   â”œâ”€â”€ components/          # UI Components
â”‚   â”‚   â”œâ”€â”€ Dice.jsx         # Header dice roller
â”‚   â”‚   â”œâ”€â”€ Party.jsx        # Party management
â”‚   â”‚   â”œâ”€â”€ Dungeon.jsx      # Dungeon grid/mapping
â”‚   â”‚   â”œâ”€â”€ Combat.jsx       # Combat system
â”‚   â”‚   â””â”€â”€ Log.jsx          # Adventure log
â”‚   â”‚
â”‚   â”œâ”€â”€ data/                # Game data & tables
â”‚   â”‚   â”œâ”€â”€ classes.js       # Character class definitions
â”‚   â”‚   â”œâ”€â”€ monsters.js      # Monster templates & tables
â”‚   â”‚   â”œâ”€â”€ rooms.js         # Room generation tables
â”‚   â”‚   â””â”€â”€ treasure.js      # Treasure & equipment tables
â”‚   â”‚
â”‚   â”œâ”€â”€ state/               # State management
â”‚   â”‚   â”œâ”€â”€ initialState.js  # Full state schema (supports campaigns)
â”‚   â”‚   â”œâ”€â”€ reducer.js       # Main reducer with all actions
â”‚   â”‚   â””â”€â”€ actions.js       # Action type constants
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/               # Utility functions
â”‚   â”‚   â”œâ”€â”€ dice.js          # Dice rolling utilities
â”‚   â”‚   â””â”€â”€ gameActions.js   # Shared game logic (spawn, treasure, combat)
â”‚   â”‚
â”‚   â””â”€â”€ hooks/               # Custom React hooks
â”‚       â””â”€â”€ useGameState.js  # State + localStorage persistence
```

## State Architecture

The app uses React's `useReducer` with localStorage persistence. The state schema supports both single adventures and campaign mode:

### Adventure Mode (default)

- Party, gold, clues reset per adventure
- Dungeon grid, monsters, encounter counters

### Campaign Mode (Phase 6)

- Party, gold, clues, equipment carry over between dungeons
- Adventure history tracking
- Stats persist across adventures

### Key State Properties

```javascript
{
  mode: 'adventure' | 'campaign',
  party: [],           // Array of hero objects
  gold: 0,             // Currency
  clues: 0,            // Clue count
  hcl: 1,              // Highest Character Level
  monsters: [],        // Active encounter
  grid: [...],         // Dungeon map (20x28)
  doors: [],           // Door positions
  abilities: {},       // Per-hero ability tracking
  log: [],             // Adventure log
  // Campaign-specific
  campaign: { ... },   // Campaign metadata & history
  adventure: { ... }   // Current adventure metadata
}
```

## Adding New Features

### Adding a new action:

1. Add constant to `src/state/actions.js`
2. Add case to `src/state/reducer.js`
3. Dispatch from components

### Adding new game data:

1. Add to appropriate file in `src/data/`
2. Import where needed

### Adding shared game logic:

1. Add to `src/utils/gameActions.js`
2. Import and use in components

## Implemented Phases

- âœ… Phase 1: Core Mechanics (party, mapping, combat, dice)
- âœ… Phase 2: Essential Game Rules (monsters, rooms, treasure, abilities)
- ðŸ”„ Phase 3: Complete Exploration (doors, traps, special rooms)
- ðŸ”„ Phase 4: Advanced Combat (spells, special actions)
- ðŸ”„ Phase 5: Polish (save slots, export, rules reference)
- ðŸ”„ Phase 6: Campaign Mode (persistence between adventures)

## Technologies

- **React 18** - UI framework
- **Vite 5** - Build tool
- **Tailwind CSS** - Styling
- **Lucide React** - Icons
- **localStorage** - State persistence
